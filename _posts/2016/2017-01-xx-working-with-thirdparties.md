---
layout: post
title: "Working with thirdparty services - challanges and best practices"
date: "2017-01-19 07:17:17"
categories: tech-stories
authors: ["Mats A."]
---

Anyone will propably know the challange of making a decision as a member of a group. Deciding something on your own is generally simpler than finding a conclusion within a group. As soon as different interest, ideas, concepts or mindsets meet, finding a satisfying compromise for everyone will be a challange. The same translates to communication between different software systems. Once you need to interact with external software services you need to adapt your implementation and sometimes make compromises. In this article I will talk about different challanges we faced as a software development team working with plenty different thirdparty services in the past years. I'll also elaborate on best practices and workflows we defined to deal with those challanges which you might find helpful once your are in the situation of working with a thirdparty service.

## Stumbelig blocks and Trap-doors

When it comes to working with thirdparty services in software development there are some tough challenges ahead of you. In this section I'll talk about the biggest challanges we already faced when working with different thirdparty services.

### In-depth knowledge required
A challenge we faced while working with thirdparty services is that some services require a lot of in-depth knowledge about the service you aim to connect to your application. For instants it requires some understanding of the US-tax system if you want to connect your software with an US accounting solution. Basically a one-way communication where you just need to fetch information from a remote source won't require as much knowledge about the target service as a bi-directional communication where you also need to publish information to the service your are connecting with. This of course can vary heavily depending on the type and purpose of integration you are aspiring to achieve.

### Increased bug potential
As soon as a software solution reaches a certain level of complexity something like a bug-free application does not exist anymore. An achivable goal is to keep the level of bugs as low as possible. You should make yourself aware that as soon as you connect your software with another external application you will duplicate the chance of bugs within your own software. The reason is that you duplicate the potential sources that can cause failures or changes that affect your application. This relation of course scales with the number of different services you connected to your software.

### Difficult debugging
Speaking of bugs - having distributed potential error sources also makes it harder to track down unexpected behaviour of the software since the root cause of the issue can stem from any of the involved sources inside or outside of you own sourcecode. Most of the time you won't have access to the debugging tools or logs of an thirdparty service and even the best API documentation will lack information about uncommon edge-cases. This often leads to a lot of [trial-and-error](https://en.wikipedia.org/wiki/Trial_and_error) debugging strategies while working with external services. Having a direct technical communication partner for the service your target can be very helpful here. Unfortunalty this isn't always the case and even if you have a technical contact the asynchronus communication will at least slow down your developing process because of all the interruptions and waiting times.

### Difficult testing conditions
Since software testing is especially important to cover very specific edge-cases it can be challanging to test your application properly once you connect with an external service. Usually integration partners will provide you sandbox environments, test credentials and well worked out documentations of the services they offer. But like mentioned before even the best documentation might miss information regarding very specific corner-cases or compromises you, as the integrator, had to commit in order to couple the different systems with each other. Furthermore even the slightest different in behaviour between a sandbox and a live environment can make a fatal difference. Providing a test environment that works excatly the same as the live environment is of course the responsibility of the service owner. Altough this usually works quite well in rare cases you can run into differences that the service provider might not even be aware of. My point is not to say you shouldn't trust sandbox environments but it's always worth to keep that fact in mind, especially in case you experience a behaviour that you are unable to reproduce with a sandbox environment.

## Our weapons of choice

The workflows and best practices we follow in our team were developed over a longer duration and are still adjusted from time to time. What I describe here is by no means meant as a ultimate guidline. It's just a collection of best practices that turned out to work out well for us as a team dealing with thirdparty services on a day to day basis.

### In-depth knowlege required
Once we know we need to create a integration with a new external service we experienced that it's very helpful to spent some time for research about the services that we want to integrate upfront. Most of the time we even go one step further and try to create a very rough prototype that spikes all the desired functionallity. Investing this effort upfront is not only helping us to create more detailed tasks out of it afterwards. It also helps to identify potential missmatches of flows and concepts between the two applications to connect, gathering open questions that need to be answered beforehand or even discover tremendous dealbreakers early on. All this information helps our product manager with his estimations as well as it helps our team during technical plannings to consider potential problems right away and minimises the necessity to postpone descions because of missunderstanding a specific service functionallity. A tool we use exacly for this purpose quite frequently is [postman](https://www.getpostman.com/). The tool allows you to play around with HTTP based APIs without having to deal with all the HTTP communication details. It helps you focus on testing the functionally of an API instead of wasting time on trivial communication details.

### Increased bug potential
While discussing the challanges of dealing with thirdparty servies, one major point was the increase of potential failures and changes. Unfortunatly there is no recipe for a magic-potion or a special trick that I can tell you to prevent this. Higher chance of bugs and changes is just a fact you need to accept and lern to deal with while working with thirdparies. In our experience the best you can do to face this fact is strictily following specific software quality guidelines. We spend quite some extra effort in order to produce readable and maintainable code since we know that it's very likely that we need to change things in the future. We also aggreed on following a common coding style and common conpects which you will be thankful for when debugging or changing parts of the software that were written by some co-worker of yours. Potentially the stronges arrow we software developers have in our quiver to deal with constant changes to our software is automated-testing. We follow a strict line to always provide a high automated test coverage of our code to ensure we won't break existing functionallity of the software with the changes we introduce. In order to minimize the chance of bugs while also sharing knowledge within the team it's very important to do frequent code reviews. Ideally every member of our team should know each module of the implementation we created.

When it comes to automated-testing there is another conecpt that can help you identify changes in external services. Create automated-test which run against their API and verify all functionallity you are using in your application. Of course you then also need to run these tests on a regular basis. Your own test-pipeline will then instantly notify you about changes your integration partner introduced to their API. This of course is especially helpful in case the communication with your integration partner is not optimal, but it might be worth the effort even in case you have good communication with your partner. Notifications regarding changes might become lost during communication in your partners company already. Relying on hard facts will always be more direct and trustworthy then relying on manual notifications. In a former blogpost on the topic of [how we test our API](https://developer.epages.com/blog/2016/09/29/rest-api-test-framework.html) you can find some ideas on how we write tests against our own API in epages.

Another strategy that at least works very well in our team is working very close with our QA engineer. Having your QA participate in concept discussions, technical-plannings and code-reviews will help him understand potential issues that might arise. Working together closely also minimises the chance for mistakes due to unclear communication or lack of background knowledge. Somtimes a QA engineer might even bring in more user-oriented feedback which helps developers identifying specific users requirements. A point that is worth considering not only for thirdparty situations but in general.

### Difficult debugging
Once all the effort you took so far wasn't enough and you end up discovering one of this beloved bugs still made it to your integration you have to face the challange of tracking down the root cause of it.
The only good practices I can provide here from experience is that you should emphasize on very understandable and comprehensive logging in your part of the integration. This will help you identifying where the nasty beetle is hiding. Comprehensive information is also important once you need to go into communication with your integration partner. It will help them understand the situation and find the problem once they know the data used to communicate with their service. Like in any human conversation it's the same for software services which are communicating with each other. Finding the root cause of a missunderstanding requires both parties to participate. That means good communication with your integration partner is very important.

### Difficult testing conditions
Talking about testing your application - after testing your solution with sandbox environments it's always benefitial to test your application also against the live enviroment. This will not always be possible but if you got the chance I'd recommend to always do it. Something you should also always do is take the feedback of your live users very seriously. Especially if you weren't able to test your solution with the live environment. Furthermore working close with customer service, QA and the partner whos service you are integrating are the best practices we discovered to face the challange of testing your application.
